// jquery.repeater version 1.2.2
// https://github.com/DubFriend/jquery.repeater
// (MIT) 19-02-2019
// Brian Detering <BDeterin@gmail.com> (http://www.briandetering.net/)

!function(a){"use strict";var b=function(a){return a},c=function(b){return a.isArray(b)},d=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(a[c],c,a)},e=function(a){return a[a.length-1]},f=function(a){return Array.prototype.slice.call(a)},g=function(){var a={};return d(f(arguments),function(b){d(b,function(b,c){a[c]=b})}),a},h=function(a,b){var c=[];return d(a,function(a,d,e){c.push(b(a,d,e))}),c},i=function(a,b,c){var e={};return d(a,function(a,d,f){d=c?c(d,a):d,e[d]=b(a,d,f)}),e},j=function(a,b,d){return c(a)?h(a,b):i(a,b,d)},k=function(a,b){return j(a,function(a){return a[b]})},l=function(a,b){var e;return c(a)?(e=[],d(a,function(a,c,d){b(a,c,d)&&e.push(a)})):(e={},d(a,function(a,c,d){b(a,c,d)&&(e[c]=a)})),e};a.fn.repeaterVal=function(){var b=function(a){if(1===a.length&&(0===a[0].key.length||1===a[0].key.length&&!a[0].key[0]))return a[0].val;d(a,function(a){a.head=a.key.shift()});var c,e=function(){var b={};return d(a,function(a){b[a.head]||(b[a.head]=[]),b[a.head].push(a)}),b}();return/^[0-9]+$/.test(a[0].head)?(c=[],d(e,function(a){c.push(b(a))})):(c={},d(e,function(a,d){c[d]=b(a)})),c};return b(function(a){var b=[];return d(a,function(a,c){var d=[];"undefined"!==c&&(d.push(c.match(/^[^\[]*/)[0]),d=d.concat(j(c.match(/\[[^\]]*\]/g),function(a){return a.replace(/[\[\]]/g,"")})),b.push({val:a,key:d}))}),b}(a(this).inputVal()))},a.fn.repeater=function(c){c=c||{};var f;return a(this).each(function(){var h=a(this),i=c.show||function(){a(this).show()},m=c.hide||function(a){a()},n=h.find("[data-repeater-list]").first(),o=function(b,c){return b.filter(function(){return!c||0===a(this).closest(k(c,"selector").join(",")).length})},p=function(){return o(n.find("[data-repeater-item]"),c.repeaters)},q=n.find("[data-repeater-item]").first().clone().hide(),r=o(o(a(this).find("[data-repeater-item]"),c.repeaters).first().find("[data-repeater-delete]"),c.repeaters);c.isFirstItemUndeletable&&r&&r.remove();var s=function(){var a=n.data("repeater-list");return c.$parent?c.$parent.data("item-name")+"["+a+"]":a},t=function(b){c.repeaters&&b.each(function(){var b=a(this);d(c.repeaters,function(a){b.find(a.selector).repeater(g(a,{$parent:b}))})})},u=function(a,b,c){a&&d(a,function(a){c.call(b.find(a.selector)[0],a)})},v=function(b,c,d){b.each(function(b){var f=a(this);f.data("item-name",c+"["+b+"]"),o(f.find("[name]"),d).each(function(){var g=a(this),h=g.attr("name").match(/\[[^\]]+\]/g),i=h?e(h).replace(/\[|\]/g,""):g.attr("name"),j=c+"["+b+"]["+i+"]"+(g.is(":checkbox")||g.attr("multiple")?"[]":"");g.attr("name",j),u(d,f,function(d){var e=a(this);v(o(e.find("[data-repeater-item]"),d.repeaters||[]),c+"["+b+"]["+e.find("[data-repeater-list]").first().data("repeater-list")+"]",d.repeaters)})})}),n.find("input[name][checked]").removeAttr("checked").prop("checked",!0)};v(p(),s(),c.repeaters),t(p()),c.initEmpty&&p().remove(),c.ready&&c.ready(function(){v(p(),s(),c.repeaters)});var w=function(){var e=function(f,g,h){if(g||c.defaultValues){var i={};o(f.find("[name]"),h).each(function(){var b=a(this).attr("name").match(/\[([^\]]*)(\]|\]\[\])$/)[1];i[b]=a(this).attr("name")}),f.inputVal(j(l(g||c.defaultValues,function(a,b){return i[b]}),b,function(a){return i[a]}))}u(h,f,function(b){var c=a(this);o(c.find("[data-repeater-item]"),b.repeaters).each(function(){var f=c.find("[data-repeater-list]").data("repeater-list");if(g&&g[f]){var h=a(this).clone();c.find("[data-repeater-item]").remove(),d(g[f],function(a){var d=h.clone();e(d,a,b.repeaters||[]),c.find("[data-repeater-list]").append(d)})}else e(a(this),b.defaultValues,b.repeaters||[])})})};return function(b,d){n.append(b),v(p(),s(),c.repeaters),b.find("[name]").each(function(){a(this).inputClear()}),e(b,d||c.defaultValues,c.repeaters)}}(),x=function(a){var b=q.clone();w(b,a),c.repeaters&&t(b),i.call(b.get(0))};f=function(a){p().remove(),d(a,x)},o(h.find("[data-repeater-create]"),c.repeaters).click(function(){x()}),n.on("click","[data-repeater-delete]",function(){var b=a(this).closest("[data-repeater-item]").get(0);m.call(b,function(){a(b).remove(),v(p(),s(),c.repeaters)})})}),this.setList=f,this}}(jQuery);