// jquery.repeater version 1.2.2
// https://github.com/DubFriend/jquery.repeater
// (MIT) 19-02-2019
// Brian Detering <BDeterin@gmail.com> (http://www.briandetering.net/)

!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],b):b(a.jQuery)}(this,function(a){"use strict";function b(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function c(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function d(a,b,d){return b&&c(a.prototype,b),d&&c(a,d),a}function e(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&g(a,b)}function f(a){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function g(a,b){return(g=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}function h(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function i(a,b){return!b||"object"!=typeof b&&"function"!=typeof b?h(a):b}function j(a){return k(a)||l(a)||m()}function k(a){if(Array.isArray(a)){for(var b=0,c=new Array(a.length);b<a.length;b++)c[b]=a[b];return c}}function l(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}function m(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function n(b){return a.isArray(b)}function o(a){return!n(a)&&a instanceof Object}function p(a){return a instanceof Function}function q(b,c){return a.inArray(c,b)}function r(a,b){return-1!==q(a,b)}function s(a,b){a&&Object.keys(a).forEach(function(c){return b(a[c],c,a)})}function t(a){return a[a.length-1]}function u(a,b){var c=[];return s(a,function(a,d,e){c.push(b(a,d,e))}),c}function v(a,b,c){var d={};return s(a,function(a,e,f){e=c?c(e,a):e,d[e]=b(a,e,f)}),d}function w(a,b,c){return n(a)?u(a,b):v(a,b,c)}function x(a,b,c){return w(a,function(a){return a[b].apply(a,j(c||[]))})}function y(b,c,d){return a(b+(d?"-".concat(d):"")+(c?"-".concat(c):""))}function z(a,b){a=n(a)?a:[a],b=n(b)?b:[b];var c=!0;return a.length!==b.length?c=!1:s(a,function(a){r(b,a)||(c=!1)}),c}function A(b){var c={},d=b.$,e=b.constructorOverride||{button:K,range:M,textarea:F,select:G,"select[multiple]":N,radio:H,checkbox:I,file:J,"file[multiple]":O,hidden:L},f=function(a,b){return Object.keys(e).indexOf(a)>-1?new e[a]({$:b}):new E({type:a,$:b})},g=function(b,e){(o(e)?e:d.find(e)).each(function(d,e){var g=a(e),h=g.attr("name");c[h]=f(b||g.attr("type"),g)})},h=function(b,e){var g=[],h=o(e)?e:d.find(e);o(e)?c[h.attr("name")]=f(b,h):(h.each(function(){var b=a(this).attr("name");-1===q(g,b)&&g.push(b)}),s(g,function(a){c[a]=f(b,d.find('input[name="'.concat(a,'"]')))}))};return d.is("input, select, textarea")?d.is('input[type="button"], button, input[type="submit"]')?g("button",d):d.is("textarea")?g("textarea",d):!d.is('input[type="text"]')&&!d.is("input")||d.attr("type")?d.is('input[type="password"]')?g("password",d):d.is('input[type="email"]')?g("email",d):d.is('input[type="url"]')?g("url",d):d.is('input[type="range"]')?g("range",d):d.is("select")?d.is("[multiple]")?g("select[multiple]",d):g("select",d):d.is('input[type="file"]')?d.is("[multiple]")?g("file[multiple]",d):g("file",d):d.is('input[type="hidden"]')?g("hidden",d):d.is('input[type="radio"]')?h("radio",d):d.is('input[type="checkbox"]')?h("checkbox",d):d.is("input[type]")?h(d.attr("type"),d):g("text",d):g("text",d):(g("button",'input[type="button"], button, input[type="submit"]'),g("range",'input[type="range"]'),g("textarea","textarea"),g("select","select:not([multiple])"),g("select[multiple]","select[multiple]"),g("file",'input[type="file"]:not([multiple])'),g("file[multiple]",'input[type="file"][multiple]'),g("hidden",'input[type="hidden"]'),h("radio",'input[type="radio"]'),h("checkbox",'input[type="checkbox"]'),g(void 0,'input[type]:not([type="file"],[type="hidden"],[type="radio"],[type="checkbox"])')),c}a=a&&a.hasOwnProperty("default")?a.default:a;var B=(function(a){for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];if(p(a));}(y,".frm"),function(){function a(){b(this,a),this.topics={}}return d(a,[{key:"publish",value:function(a,b){s(this.topics[a],function(a){a(b)})}},{key:"subscribe",value:function(a,b){this.topics[a]=this.topics[a]||[],this.topics[a].push(b)}},{key:"unsubscribe",value:function(a){s(this.topics,function(b){var c=q(b,a);-1!==c&&b.splice(c,1)})}}]),a}()),C=function(a){function c(a){var d;return b(this,c),d=i(this,f(c).call(this)),d.$self=a.$,d}return e(c,a),d(c,[{key:"getType",value:function(){throw'implement me (return type. "text", "radio", etc.)'}},{key:"$",value:function(a){return a?this.$self.find(a):this.$self}},{key:"disable",value:function(){this.$().prop("disabled",!0),this.publish("isEnabled",!1)}},{key:"enable",value:function(){this.$().prop("disabled",!1),this.publish("isEnabled",!0)}},{key:"equalTo",value:function(a,b){return a===b}},{key:"publishChange",value:function(a,b){var c=this.get();this.equalTo(c,this.oldValue)||this.publish("change",{e:a,domElement:b}),this.oldValue=c}}]),c}(B),D=function(a){function c(){return b(this,c),i(this,f(c).apply(this,arguments))}return e(c,a),d(c,[{key:"get",value:function(){return this.$().val()}},{key:"set",value:function(a){this.$().val(a)}},{key:"clear",value:function(){this.set("")}},{key:"buildSetter",value:function(a){var b=this;return function(c){return a.call(b,c)}}}]),c}(C),E=function(a){function c(a){var d;return b(this,c),d=i(this,f(c).call(this,a)),a.type&&(d.$type=a.type),d.$().on("change keyup keydown",function(a){return d.publishChange(a,a.target)}),d}return e(c,a),d(c,[{key:"getType",value:function(){return this.$type||"text"}}]),c}(D),F=function(a){function c(a){var d;return b(this,c),d=i(this,f(c).call(this,a)),d.$().on("change keyup keydown",function(a){return d.publishChange(a,a.target)}),d}return e(c,a),d(c,[{key:"getType",value:function(){return"textarea"}}]),c}(D),G=function(a){function c(a){var d;return b(this,c),d=i(this,f(c).call(this,a)),d.$().change(function(a){return d.publishChange(a,a.target)}),d}return e(c,a),d(c,[{key:"getType",value:function(){return"select"}}]),c}(D),H=function(c){function g(a){var c;return b(this,g),c=i(this,f(g).call(this,a)),c.$().change(function(a){return c.publishChange(a,a.target)}),c}return e(g,c),d(g,[{key:"getType",value:function(){return"radio"}},{key:"get",value:function(){return this.$().filter(":checked").val()||null}},{key:"set",value:function(b){b?this.$().filter('[value="'.concat(b,'"]')).prop("checked",!0):this.$().each(function(){a(this).prop("checked",!1)})}}]),g}(D),I=function(c){function g(a){var c;return b(this,g),c=i(this,f(g).call(this,a)),c.$().change(function(a){return c.publishChange(a,a.target)}),c}return e(g,c),d(g,[{key:"getType",value:function(){return"checkbox"}},{key:"get",value:function(){var b=this,c=[];return this.$().filter(":checked").each(function(d,e){c.push(a(b).val(e))}),c}},{key:"set",value:function(b){var c=this;b=n(b)?b:[b],this.$().each(function(){a(this).prop("checked",!1)}),s(b,function(a){c.$().filter('[value="'.concat(a,'"]')).prop("checked",!0)})}},{key:"equalTo",value:function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];z(b)}}]),g}(D),J=function(c){function g(a){var c;return b(this,g),c=i(this,f(g).call(this,a)),c.$().change(function(a){return c.publishChange(a,a.target)}),c}return e(g,c),d(g,[{key:"getType",value:function(){return"file"}},{key:"get",value:function(){return t(this.$().val().split("\\"))}},{key:"clear",value:function(){this.$().each(function(b,c){a(c).wrap("<form>").closest("form").get(0).reset(),a(c).unwrap()})}}]),g}(C),K=function(a){function c(a){var d;return b(this,c),d=i(this,f(c).call(this,a)),d.$().on("change",function(a){return d.publishChange(a,a.target)}),d}return e(c,a),d(c,[{key:"getType",value:function(){return"button"}}]),c}(D),L=function(a){function c(a){var d;return b(this,c),d=i(this,f(c).call(this,a)),d.$().change(function(a){return d.publishChange(a,a.target)}),d}return e(c,a),d(c,[{key:"getType",value:function(){return"hidden"}}]),c}(D),M=function(a){function c(a){var d;return b(this,c),d=i(this,f(c).call(this,a)),d.$().change(function(a){return d.publishChange(a,a.target)}),d}return e(c,a),d(c,[{key:"getType",value:function(){return"range"}}]),c}(D),N=function(a){function c(a){var d;return b(this,c),d=i(this,f(c).call(this,a)),d.$().change(function(a){return d.publishChange(a,a.target)}),d}return e(c,a),d(c,[{key:"getType",value:function(){return"select[multiple]"}},{key:"get",value:function(){return this.$().val()||[]}},{key:"set",value:function(a){var b;b=""===a?[]:n(a)?a:[a],this.$().val(b)}},{key:"equalTo",value:function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];z(b)}}]),c}(D),O=function(c){function g(a){var c;return b(this,g),c=i(this,f(g).call(this,a)),c.$().change(function(a){return c.publishChange(a,a.target)}),c}return e(g,c),d(g,[{key:"getType",value:function(){return"file[multiple]"}},{key:"get",value:function(){var a,b=this.$().get(0).files||[],c=[];for(a=0;a<(b.length||0);a+=1)c.push(b[a].name);return c}},{key:"clear",value:function(){this.$().each(function(b,c){a(c).wrap("<form>").closest("form").get(0).reset(),a(c).unwrap()})}}]),g}(C);a.fn.inputVal=function(b){var c=a(this),d=A({$:c});return c.is("input, textarea, select")?void 0===b?d[c.attr("name")].get():(d[c.attr("name")].set(b),c):void 0===b?x(d,"get"):(s(b,function(a,b){d[b]&&d[b].set(a)}),c)},a.fn.inputOnChange=function(b){var c=a(this);return s(A({$:c}),function(a){a.subscribe("change",function(a){b.call(a.domElement,a.e)})}),c},a.fn.inputDisable=function(){var b=a(this);return x(A({$:b}),"disable"),b},a.fn.inputEnable=function(){var b=a(this);return x(A({$:b}),"enable"),b},a.fn.inputClear=function(){var b=a(this);return x(A({$:b}),"clear"),b}}),function(a){"use strict";var b=function(a){return a},c=function(b){return a.isArray(b)},d=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(a[c],c,a)},e=function(a){return a[a.length-1]},f=function(a){return Array.prototype.slice.call(a)},g=function(){var a={};return d(f(arguments),function(b){d(b,function(b,c){a[c]=b})}),a},h=function(a,b){var c=[];return d(a,function(a,d,e){c.push(b(a,d,e))}),c},i=function(a,b,c){var e={};return d(a,function(a,d,f){d=c?c(d,a):d,e[d]=b(a,d,f)}),e},j=function(a,b,d){return c(a)?h(a,b):i(a,b,d)},k=function(a,b){return j(a,function(a){return a[b]})},l=function(a,b){var e;return c(a)?(e=[],d(a,function(a,c,d){b(a,c,d)&&e.push(a)})):(e={},d(a,function(a,c,d){b(a,c,d)&&(e[c]=a)})),e};a.fn.repeaterVal=function(){var b=function(a){if(1===a.length&&(0===a[0].key.length||1===a[0].key.length&&!a[0].key[0]))return a[0].val;d(a,function(a){a.head=a.key.shift()});var c,e=function(){var b={};return d(a,function(a){b[a.head]||(b[a.head]=[]),b[a.head].push(a)}),b}();return/^[0-9]+$/.test(a[0].head)?(c=[],d(e,function(a){c.push(b(a))})):(c={},d(e,function(a,d){c[d]=b(a)})),c};return b(function(a){var b=[];return d(a,function(a,c){var d=[];"undefined"!==c&&(d.push(c.match(/^[^\[]*/)[0]),d=d.concat(j(c.match(/\[[^\]]*\]/g),function(a){return a.replace(/[\[\]]/g,"")})),b.push({val:a,key:d}))}),b}(a(this).inputVal()))},a.fn.repeater=function(c){c=c||{};var f;return a(this).each(function(){var h=a(this),i=c.show||function(){a(this).show()},m=c.hide||function(a){a()},n=h.find("[data-repeater-list]").first(),o=function(b,c){return b.filter(function(){return!c||0===a(this).closest(k(c,"selector").join(",")).length})},p=function(){return o(n.find("[data-repeater-item]"),c.repeaters)},q=n.find("[data-repeater-item]").first().clone().hide(),r=o(o(a(this).find("[data-repeater-item]"),c.repeaters).first().find("[data-repeater-delete]"),c.repeaters);c.isFirstItemUndeletable&&r&&r.remove();var s=function(){var a=n.data("repeater-list");return c.$parent?c.$parent.data("item-name")+"["+a+"]":a},t=function(b){c.repeaters&&b.each(function(){var b=a(this);d(c.repeaters,function(a){b.find(a.selector).repeater(g(a,{$parent:b}))})})},u=function(a,b,c){a&&d(a,function(a){c.call(b.find(a.selector)[0],a)})},v=function(b,c,d){b.each(function(b){var f=a(this);f.data("item-name",c+"["+b+"]"),o(f.find("[name]"),d).each(function(){var g=a(this),h=g.attr("name").match(/\[[^\]]+\]/g),i=h?e(h).replace(/\[|\]/g,""):g.attr("name"),j=c+"["+b+"]["+i+"]"+(g.is(":checkbox")||g.attr("multiple")?"[]":"");g.attr("name",j),u(d,f,function(d){var e=a(this);v(o(e.find("[data-repeater-item]"),d.repeaters||[]),c+"["+b+"]["+e.find("[data-repeater-list]").first().data("repeater-list")+"]",d.repeaters)})})}),n.find("input[name][checked]").removeAttr("checked").prop("checked",!0)};v(p(),s(),c.repeaters),t(p()),c.initEmpty&&p().remove(),c.ready&&c.ready(function(){v(p(),s(),c.repeaters)});var w=function(){var e=function(f,g,h){if(g||c.defaultValues){var i={};o(f.find("[name]"),h).each(function(){var b=a(this).attr("name").match(/\[([^\]]*)(\]|\]\[\])$/)[1];i[b]=a(this).attr("name")}),f.inputVal(j(l(g||c.defaultValues,function(a,b){return i[b]}),b,function(a){return i[a]}))}u(h,f,function(b){var c=a(this);o(c.find("[data-repeater-item]"),b.repeaters).each(function(){var f=c.find("[data-repeater-list]").data("repeater-list");if(g&&g[f]){var h=a(this).clone();c.find("[data-repeater-item]").remove(),d(g[f],function(a){var d=h.clone();e(d,a,b.repeaters||[]),c.find("[data-repeater-list]").append(d)})}else e(a(this),b.defaultValues,b.repeaters||[])})})};return function(b,d){n.append(b),v(p(),s(),c.repeaters),b.find("[name]").each(function(){a(this).inputClear()}),e(b,d||c.defaultValues,c.repeaters)}}(),x=function(a){var b=q.clone();w(b,a),c.repeaters&&t(b),i.call(b.get(0))};f=function(a){p().remove(),d(a,x)},o(h.find("[data-repeater-create]"),c.repeaters).click(function(){x()}),n.on("click","[data-repeater-delete]",function(){var b=a(this).closest("[data-repeater-item]").get(0);m.call(b,function(){a(b).remove(),v(p(),s(),c.repeaters)})})}),this.setList=f,this}}(jQuery);